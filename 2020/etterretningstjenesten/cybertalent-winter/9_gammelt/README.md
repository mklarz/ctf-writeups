# 9_gammelt

Having completed last years CTF, solving it again was fairly easy. See the following writeups: [Sithis](https://github.com/williamsolem/Etjenesten-Cybertalent-CTF-Writeup), [Agent Random](https://blog.agentrandom.com/cybertalent-ctf/), [zig](https://www.indregard.no/2020/03/e-tjenestens-ctf/), [UnblvR](https://github.com/myrdyr/ctf-writeups/tree/master/etjenesten20), or [SgtSIGSEGV](https://blog.mrfjo.org/2020/03/02/NIS-Cybertalent).

```
login@corax:~$ scoreboard --secret-shares
Dine andeler:

3.1. Utfordringer lett
3.1.1_clmystery           f4(1)=103897326758549940055925588924916   f9(1)=78416662352898028738456380336979

9. Gammelt
9.1.1_keystore            f4(2)=10340134542888813646404431216601    f9(2)=54512220361155434109080573852585
9.1.2_lootd               f4(3)=123697489095005887704911474000161   f9(3)=105595548362576193712398929798566
9.1.3_loot_home           f4(4)=117384148289252695240809037788732   f9(4)=22896490884629287279847925445605
9.1.4_loot_vault          f4(5)=151592700487620859438193473959831   f9(5)=84422722942423784717598068928766
9.1.5_headquarters        f4(6)=61997180393675276698005113314721    f9(6)=81404089063428665757085837518732
9.1.6_decryption          f4(7)=8790176369407570204340307230919     f9(7)=129588987433539636912903729062440
9.2.2_knock-knock         f4(8)=152164276776809363141295407085942   f9(8)=20207262580225677916488220830573
9.2.3_runer               f4(9)=3274962661018825126654723104799     f9(9)=31266589518595858674009820958195
9.2.4_sharing_secrets_k=3 f4(10)=46833376042454306127670627241261    f9(10)=116256089605332522308483017004116
9.3.1_artwork_del_2       f4(11)=118513551624680702545283450296591   f9(11)=66405607367904648551344286239019
9.3.2_explosion_6         f4(12)=53989524111262910780433523072052    f9(12)=159722817821421307308764136797968
```

```python
from shamir import recover_secret

# 11 Mersenne-primtallet
# p = 107
PRIME = (2 ** 107) - 1

k4_shares = [
    (1, 103897326758549940055925588924916),
    (2, 10340134542888813646404431216601),
    (3, 123697489095005887704911474000161),
    (4, 117384148289252695240809037788732),
    (5, 151592700487620859438193473959831),
    (6, 61997180393675276698005113314721),
    (7, 8790176369407570204340307230919),
    (8, 152164276776809363141295407085942),
    (9, 3274962661018825126654723104799),
    (10, 46833376042454306127670627241261),
    (11, 118513551624680702545283450296591),
    (12, 53989524111262910780433523072052),
]

k9_shares = [
    (1, 78416662352898028738456380336979),
    (2, 54512220361155434109080573852585),
    (3, 105595548362576193712398929798566),
    (4, 22896490884629287279847925445605),
    (5, 84422722942423784717598068928766),
    (6, 81404089063428665757085837518732),
    (7, 129588987433539636912903729062440),
    (8, 20207262580225677916488220830573),
    (9, 31266589518595858674009820958195),
    (10, 116256089605332522308483017004116),
    (11, 66405607367904648551344286239019),
    (12, 159722817821421307308764136797968),
]

k4 = recover_secret(k4_shares, PRIME)
print("k=4:", k4)
k9 = recover_secret(k9_shares, PRIME)
print("k=9:", k9)
```


```shell
$ python3 solve.py
k=4: 81917200550784280357800585459462
k=9: 61560476151908271085933851404811
```
```shell
login@corax:~$ scoreboard 81917200550784280357800585459462
Kategori: 9. Gammelt
Oppgave:  9.2.4_sharing_secrets_k=4
Svar:     81917200550784280357800585459462

Gratulerer, korrekt svar!
```
```shell
login@corax:~$ scoreboard 61560476151908271085933851404811
Kategori: 9. Gammelt
Oppgave:  9.2.4_sharing_secrets_k=9
Svar:     61560476151908271085933851404811

Gratulerer, korrekt svar!
```
